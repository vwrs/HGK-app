version: 0.2

phases:
  pre_build:
    commands:
      - $(aws ecr get-login --no-include-email --region ap-northeast-1)
    finally:
      - docker login -u AWS -p eyJwYXlsb2FkIjoiemFmU2dSMVgvbTJCclNieG50TlM3SXJmN1FQZTZhUGRHbkdHSjYxaklrTld1MkpRdTY3amhpNkFET3IzTEh4RHorcGhtWENoNHJOb3FmWEo5TS9Qa0o4UzFFNDJrTWl6aTJkUmtzWGFEZ2RHSTdGMmx0MDk2dlZtenoxODVwaFRWL1Y1ZUtLaFJ5R3FKWTJ6cUNtL0IycldkeUFtWWV1VnB1TEpwZ3RjcmtLaVRPbHBTc3Y3cTFySEJNcWxSWDJhRDQvTU5wY2pXUnNyWFBOZkViUWNwM1NRZW5nbERoeHRXY1hGdHFPMFFHUnVXR1RueUhoM3JjNUc3VlM5UUpvZ212WThFUksvZFB5VlZHMzQ5N01qZ2haV21uVW0rNk9XQi9tWmRNOEFxS0hVSlB1Uk90M2UybWsxMFc3UXNUd2c4amNhUC9ESkd5ckNiUllFOEQzQm01WVZnMGo3QVpCSURZWGswVzBiV2NQUkxNRFJpRVkrQWlTNDBBRVFxVjVQbzlvejA2NmZCNTFlNWdaeERpY3dZaC80N1NNQnh3dkg2NnRUNk5ueWsxTk02RmE3eFNRSXNmcVZQcFNKVldlUGUwNTN6VDFncVNrSVE0Z055aWZSaHRQNjd5R3lMeWdLSU9uTVJlVmxWbm5WUFU0TE9xam5zVWhjdE5YY3dIalMwRUdDWnBCblNCOVZTeE16ZEJDM1MyWFFkUDNyczRLOGVjZ2dybzZja0ZQajd6Mm52M1l1NkNXQlpjNUlIYXpPaXl2UFFaVjVhUXdCVmlPZVpHTndpS3h3eFRHRnpUaVErQUgrcWlqZ0VmZEE1NzlMR2VjTDlWWCthZlBPaTMwYmdoSmZpdHk2SnduSDEzaDZLNWZtdDhmQWFKWWtJN1k2VHppNmthZlIzeERVUlp3ZUtoaDBKQXBmdzJoOVpHWGExQ3R6NUpNRHhwVzJiNDM1S0FkQ3h3YXNPN0NOTnFFekUxSzFqMUQ3R1Era2FjZUpWM2xxeWZDLzdUYVhua1UwcnRYTXBCaVJIR1ZrcVd3M0QrUzh3QlRRNzQvUWl2VmJzNHdhTk9sSGVNaTNUK01GUEtpZGxlcFBUMmZVN1Y0bldNV1A2RkkxS3ljN04vMzV3WVFVQnhTb3daM2RrK3F3VVVFRHRPNkZrVWtkYTZyTlVZVzN3WE5BSVRUY3ZOZEdFREtURTJrajhZOVVqM2g2d0w1VW5pV1Fxc0ZaekdlMDZ3TWNSSVlsdUhTMWJhdjQzY0JLNlFZWDZ4a2JKTDlneS9DdExJMm12Q2lRdEErL0dCODFTcXgxMjV0V3hWd29GUWsrdDF0VW81NmVzTmJkcHJiSE1EdFRqWG9kMGJ5cWNkVFpkOU80RDkzMlg5eUZtL0o2TEE0aFJPQzFhVHBNcmZLeEM3NEs1cFJmWU1reTBzQ0g5UGV5enZ4b2FzT0FqQ2dhVG1rZmphSVh6UTJnMUE1U0NKSDlRaVFmUk5mTTJoYmpFS211ZEE9PSIsImRhdGFrZXkiOiJBUUVCQUhnQU1mS0RsSW9wQzZ6czBiTWRScllTSGEvQzM5a0NyY1A4a1ZwckU5ZitrUUFBQUg0d2ZBWUpLb1pJaHZjTkFRY0dvRzh3YlFJQkFEQm9CZ2txaGtpRzl3MEJCd0V3SGdZSllJWklBV1VEQkFFdU1CRUVETWhqYnR3Qi9XMXJsV2o5VXdJQkVJQTdtWWdMb0lwVjFvdWVUYTNVUWpjdXo4emRlWm9oRHRXQ0hNNGV2MCtYek5MSVpvZ3E0a3RRMDdoWkZrQXlIdTVWQ0hhYmRtYXFYcDNaSXNVPSIsInZlcnNpb24iOiIyIiwidHlwZSI6IkRBVEFfS0VZIiwiZXhwaXJhdGlvbiI6MTUzNjI0Nzk2MX0= https://756081124733.dkr.ecr.ap-northeast-1.amazonaws.com

  build:
    commands:
      - docker build -t hgk/app .
      - docker tag hgk/app:latest 756081124733.dkr.ecr.ap-northeast-1.amazonaws.com/hgk/app:latest
  post_build:
    commands:
      - docker push 756081124733.dkr.ecr.ap-northeast-1.amazonaws.com/hgk/app:latest
